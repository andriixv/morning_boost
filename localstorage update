(function() {
    const STORAGE_KEY = 'productiveMorningData_v3';
    const appData = JSON.parse(localStorage.getItem(STORAGE_KEY));

    if (!appData) {
        alert("–î–∞–Ω—ñ –¥–æ–¥–∞—Ç–∫–∞ —â–µ –Ω–µ —Å—Ç–≤–æ—Ä–µ–Ω—ñ. –°–ø–æ—á–∞—Ç–∫—É –≤—ñ–¥–∫—Ä–∏–π –¥–æ–¥–∞—Ç–æ–∫ —Ö–æ—á–∞ –± —Ä–∞–∑.");
        return;
    }

    // === –§–£–ù–ö–¶–Ü–Ø –î–û–î–ê–í–ê–ù–ù–Ø –î–ê–ù–ò–• –ó–ê–î–ù–Ü–ú –ß–ò–°–õ–û–ú ===
    window.addRecordForDate = function(dateString, options = {}) {
        if (!/^\d{4}-\d{2}-\d{2}$/.test(dateString)) {
            console.error("‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π —Ñ–æ—Ä–º–∞—Ç –¥–∞—Ç–∏! –í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ YYYY-MM-DD, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥ '2025-10-20'");
            return;
        }

        const record = {
            goals: options.goalsCount ?? 3,
            completed: options.completedCount ?? 0,
        };

        // –ó–±–µ—Ä—ñ–≥–∞—î–º–æ –∑–∞–ø–∏—Å–∏ –ø—Ä–æ —Ü—ñ–ª—ñ
        appData.dailyRecords[dateString] = record;

        // –ù–∞—Å—Ç—Ä—ñ–π (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
        if (options.mood) {
            appData.moods[dateString] = options.mood;
        }

        // –í–¥—è—á–Ω—ñ—Å—Ç—å (–æ–ø—Ü—ñ–æ–Ω–∞–ª—å–Ω–æ)
        if (options.gratitude) {
            if (!appData.pastGratitudes) appData.pastGratitudes = {};
            appData.pastGratitudes[dateString] = options.gratitude;
        }

        localStorage.setItem(STORAGE_KEY, JSON.stringify(appData));
        console.log(`‚úÖ –î–∞–Ω—ñ –∑–∞ ${dateString} —É—Å–ø—ñ—à–Ω–æ –¥–æ–¥–∞–Ω–æ –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–æ.`);
        console.table(record);
        if (options.mood) console.log("–ù–∞—Å—Ç—Ä—ñ–π:", options.mood);
        if (options.gratitude) console.log("–í–¥—è—á–Ω—ñ—Å—Ç—å:", options.gratitude);
    };

    console.log(`
‚úÖ –°–∫—Ä–∏–ø—Ç –¥–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è –¥–∞–Ω–∏—Ö "–∑–∞–¥–Ω—ñ–º —á–∏—Å–ª–æ–º" –∞–∫—Ç–∏–≤–æ–≤–∞–Ω–æ.
–í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –ø—Ä–∏–∫–ª–∞–¥—É:
addRecordForDate("2025-10-20", {
    goalsCount: 3,
    completedCount: 2,
    mood: "üòä",
    gratitude: "–ó–∞ –≥–∞—Ä–Ω–∏–π –¥–µ–Ω—å —ñ –∫–∞–≤—É ‚òï"
});
`);
})();
